<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRBRP | Training Assist</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script>
        const CONFIG = {
            WEBHOOK: "https://discord.com/api/webhooks/1464977885629779990/D-mwGVTC23B7dsnZ70p5TFyV1mvLACJLKVmF9xJtsd2Othgg7VzwzMwOCFU8Wd_v6rni",
            ANNOUNCE_ROLE_ID: "1381367978611839136",
            ACCESS_KEY: "Merse noob",
            THUMBNAIL: "https://cdn.discordapp.com/attachments/1460325955963846819/1465253303234330677/Hrbrp.png?ex=69786efa&is=69771d7a&hm=34283654c5b9e97f2a5ec16a212fddb316e7fb676d16c12f7c61d2efc9a902ba&",
            IMG_ANN: "https://cdn.discordapp.com/attachments/1434075893868920852/1453697838994296855/HRPBRP_Announcement.png",
            IMG_RES: "https://media.discordapp.net/attachments/1460325955963846819/1464990348416909536/High_Rock_Banners_31.png?ex=697822d5&is=6976d155&hm=3521853af6005b6a809e4badeb16727dd6e387b5c5949a73be2b9739d7e857f6&=&format=webp&quality=lossless&width=1214&height=363",
            IMG_VV: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAJCAYAAABT2S4KAAAEvElEQVR4AQCBAH7/AHc9WP93PVj/dj5Y/3Q+Wf9yPln/cD9a/20/W/9rQFz/Z0Bd/2RBXv9hQV//XUJg/1pCYf9XQ2L/U0Ni/1BDY/9OQ2P/S0Nj/0lDY/9HQ2P/RkNj/0RDY/9DQmL/QkJi/0JBYf9BQWH/QUFg/0FAYP9BQF//QUBf/0FAX/9BP17/AIEAfv8Afz1S/349Uv99PVL/fD5T/3o+VP94PlT/dT9V/3I/Vv9vQFf/bEBY/2hBWf9lQVr/YUJb/15CXP9bQ1z/WENd/1VDXf9TQ13/UUNd/09DXf9NQl3/TEJc/0tCXP9KQVv/SkFb/0lAWv9JQFr/SUBZ/0g/Wf9IP1j/SD9Y/0g/WP8AgQB+/wCLPEn/ijxJ/4k9Sf+IPUr/hj1L/4M+S/+BPkz/fj9N/3s/Tv93QE//dEBQ/3FBUf9tQVH/akJS/2dCU/9kQlP/YkJT/19CU/9dQlP/W0JT/1pCU/9YQVL/V0FS/1dBUf9WQFH/VkBQ/1U/T/9VP0//VT9O/1U+Tv9VPk7/VT5O/wCBAH7/AJY8QP+WPEH/lTxB/5M9Qf+RPUL/jz5D/4w+RP+KP0T/hj9F/4NARv+AQEf/fUFI/3lBSP92QUn/c0JJ/3BCSv9uQkr/a0JK/2lCSv9nQkn/ZkFJ/2VBSf9kQUj/Y0BH/2JAR/9iP0b/Yj9F/2E/Rf9hPkT/YT5E/2E+RP9hPkP/AIEAfv8AnT08/509PP+cPT3/mj49/5g+Pv+WPj7/kz8//5E/QP+OQEH/ikBB/4dBQv+EQUP/gUJD/31CRP96QkT/eENE/3VDRP9zQ0T/cUNE/29CRP9uQkP/bEJD/2tBQv9rQUH/akFB/2pAQP9qQD//aT8+/2k/Pv9pPz7/aT89/2k/Pf8AgQB+/wCdPz3/nT89/5w/Pv+bPz7/mUA//5dAP/+UQUD/kUFB/45CQf+LQkL/iEND/4VDQ/+BRET/fkRE/3tERf95REX/dkRF/3RERP9yRET/cERE/29EQ/9uQ0L/bUNC/2xDQf9sQkD/a0I//2tBPv9rQT7/a0E9/2tAPf9rQDz/a0A8/wCBAH7/AJhBQ/+YQUP/l0FD/5ZCRP+UQkT/kkJF/49DRf+MQ0b/iURH/4ZER/+DRUj/gEVJ/31GSf96Rkn/d0ZJ/3RHSf9yR0n/b0dJ/21GSf9sRkj/akZH/2lGR/9oRUb/aEVF/2dERP9nREP/Z0NC/2dDQv9nQ0H/Z0NB/2dCQP9nQkD/AIEAfv8AkkNK/5FDSv+QREr/j0RL/41ES/+LRUz/iEVM/4VGTf+CRk7/f0dO/3xHT/95SE//dkhQ/3NIUP9wSVD/bUlQ/2tJUP9pSU//Z0lP/2VITv9kSE3/Y0hN/2JHTP9hR0v/YUZK/2FGSf9gRkj/YEVH/2BFR/9gRUb/YERG/2BERv8BgQB+/wCNRU//jEVP/4tFT/+KRU//iEZQ/4ZGUP+DRlH/gUdS/35IUv97SFP/d0lT/3RJVP9xSVT/bkpU/2tKVP9pSlT/ZkpU/2RKVP9iSlP/YUpS/19JUv9eSVH/XUlQ/11IT/9cSE7/XEdN/1xHTP9cR0v/XEZL/1xGSv9cRkr/XEZK/7p1PCVMGGmNAAAAAElFTkSuQmCC"
        };
    </script>
    <style>
        :root {
            --bg: #05070a; --panel: rgba(16, 20, 35, 0.95);
            --pink: #ff00ff; --blue: #00f2ff; --gold: #ffcc00;
            --pass: #00ff88; --fail: #ff4444; --text: #ffffff;
            --okay: #d6d31b;
        }
        body { font-family: 'Inter', sans-serif; background: radial-gradient(circle at top right, #1a0b2e, #05070a); color: var(--text); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        #login-screen { background: var(--panel); padding: 50px; border: 2px solid var(--pink); border-radius: 20px; text-align: center; margin-top: 100px; }
        #dashboard { display: none; width: 95%; max-width: 1100px; background: var(--panel); backdrop-filter: blur(15px); border-radius: 24px; border: 1px solid rgba(255, 255, 255, 0.1); margin: 20px 0; }
        .tabs { display: flex; background: rgba(0,0,0,0.4); border-radius: 24px 24px 0 0; overflow: hidden; }
        .tab { flex: 1; padding: 20px; text-align: center; cursor: pointer; color: #666; font-weight: 800; text-transform: uppercase; transition: 0.3s; }
        .tab.active { color: var(--blue); border-bottom: 3px solid var(--blue); background: rgba(0, 242, 255, 0.05); }
        .content { padding: 40px; display: none; }
        .content.active { display: block; }
        label { display: block; margin-top: 15px; color: var(--blue); font-size: 0.75rem; font-weight: 800; text-transform: uppercase; }
        input, textarea, select { background: rgba(0,0,0,0.4); border: 1px solid var(--blue); color: white; padding: 12px; width: 100%; border-radius: 8px; margin-top: 5px; box-sizing: border-box; }
        .eval-section { border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; margin-top: 20px; background: rgba(255,255,255,0.02); }
        .eval-section h4 { margin-top: 0; color: var(--gold); border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 5px; }
        .btn-grp { display: flex; gap: 5px; margin-top: 5px; }
        .t-btn { padding: 8px; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: white; border-radius: 6px; font-weight: bold; font-size: 0.7rem; flex: 1; }
        .t-btn.active-green { background: var(--pass); color: #000; }
        .t-btn.active-red { background: var(--fail); color: #fff; }
        .primary-btn { background: var(--blue); color: black; border: none; padding: 18px; width: 100%; border-radius: 12px; font-weight: 800; cursor: pointer; margin-top: 25px; text-transform: uppercase; }
        .batch-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .section-note { height: 60px; font-size: 0.8rem; margin-top: 10px; border: 1px dashed rgba(0, 242, 255, 0.3); }
    </style>
</head>
<body>

    <div id="login-screen">
        <h1 style="color: var(--gold); font-weight: 800;">HRBRP | Training Assist</h1>
        <input type="password" id="pass-field" style="text-align:center" placeholder="ACCESS KEY">
        <button onclick="unlock()" class="primary-btn">INITIALIZE</button>
    </div>

    <div id="dashboard">
        <div class="tabs">
            <div class="tab active" onclick="switchTab('ann')">Announcements</div>
            <div class="tab" onclick="switchTab('res')">Results</div>
            <div class="tab" onclick="switchTab('voice')">Voice Verify</div>
        </div>

        <div id="ann-content" class="content active">
            <h2>NEW ANNOUNCEMENT</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div><label>Trainer Discord ID</label><input type="text" id="ann-uid"></div>
                <div><label>Training Type</label><input type="text" id="ann-type" value="Standard Training"></div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div><label>Location</label><input type="text" id="ann-loc" value="Sheriff Briefing Room"></div>
                <div><label>Start Time (Required)*</label><input type="datetime-local" id="ann-time"></div>
            </div>
            <label>Instructions</label>
            <textarea id="ann-desc" rows="4">All attendees must be in the Briefing Room 5 mins prior.</textarea>
            <button onclick="postAnn()" class="primary-btn">POST ANNOUNCEMENT</button>
        </div>

        <div id="res-content" class="content">
            <h2>BATCH EVALUATOR (40 MARKS)</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; background: rgba(0,0,0,0.3); padding: 20px; border-radius: 15px;">
                <div><label>Host Roblox</label><input type="text" id="h-rblx" oninput="saveHost()"></div>
                <div><label>Host Discord ID</label><input type="text" id="h-id" oninput="saveHost()"></div>
            </div>

            <div style="margin-top: 30px; padding: 25px; border: 1px solid var(--pink); border-radius: 20px;">
                <h3 style="color: var(--pink);">TRAINEE INPUT</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <input type="text" id="t-rblx" placeholder="Roblox Username">
                    <input type="text" id="t-id" placeholder="Discord User ID">
                </div>

                <div class="eval-section">
                    <h4>KNOWLEDGE SECTION (20 MARKS)</h4>
                    <div id="k-cont" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;"></div>
                    <textarea id="note-k" class="section-note" placeholder="Knowledge Notes (Optional)"></textarea>
                </div>

                <div class="eval-section">
                    <h4>MOD-CALL/DRIVING (20 MARKS)</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div><label>Mod Call Protocol</label><div class="btn-grp"><button class="t-btn" onclick="setTog('m1', 5, this)">Pass</button><button class="t-btn" onclick="setTog('m1', 0, this)">Fail</button></div></div>
                        <div><label>SPaG</label><div class="btn-grp"><button class="t-btn" onclick="setTog('m2', 5, this)">Pass</button><button class="t-btn" onclick="setTog('m2', 0, this)">Fail</button></div></div>
                        <div><label>Vehicle Control</label><div class="btn-grp"><button class="t-btn" onclick="setTog('m3', 5, this)">Pass</button><button class="t-btn" onclick="setTog('m3', 0, this)">Fail</button></div></div>
                        <div><label>Road Safety</label><div class="btn-grp"><button class="t-btn" onclick="setTog('m4', 5, this)">Pass</button><button class="t-btn" onclick="setTog('m4', 0, this)">Fail</button></div></div>
                    </div>
                    <textarea id="note-m" class="section-note" placeholder="Mod-Call/Driving Notes (Optional)"></textarea>
                </div>

                <label>Overall Comments</label>
                <textarea id="note-ov" placeholder="Final summary..."></textarea>
                
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 10px; margin-top: 20px;">
                    <button onclick="addTrainee()" class="primary-btn" style="background: var(--pass); margin-top:0;">ADD TO BATCH</button>
                    <button onclick="dqTrainee()" class="primary-btn" style="background: var(--fail); color:white; margin-top:0;">DQ</button>
                </div>
            </div>
            <div id="batch-list" style="margin-top: 20px;"></div>
            <button id="pub-btn" onclick="publish()" class="primary-btn" style="background: var(--pink); display:none;">PUBLISH ALL</button>
        </div>

        <div id="voice-content" class="content">
            <h2>VOICE VERIFICATION</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div><label>Trainer ID</label><input type="text" id="v-tr-id"></div>
                <div><label>Trainee ID</label><input type="text" id="v-tn-id"></div>
            </div>
            <label>Roblox Name</label><input type="text" id="v-name">
            <label>Age Group</label>
            <select id="v-age"><option>Under 13</option><option>13-15</option><option>15-17</option><option>18+</option></select>
            <button onclick="postVoiceVerify()" class="primary-btn" style="background: var(--gold); color:black;">SUBMIT VERIFY</button>
        </div>
    </div>

    <script>
        let batch = [], scores = {};
        const kCont = document.getElementById('k-cont');
        // Questions are 2 points each = 20 total
        for(let i=1; i<=10; i++) kCont.innerHTML += `<div><label>Q${i}</label><div class="btn-grp"><button class="t-btn" onclick="setTog('k${i}',2,this)">✓</button><button class="t-btn" onclick="setTog('k${i}',0,this)">✗</button></div></div>`;

        function unlock() { if(document.getElementById('pass-field').value === CONFIG.ACCESS_KEY) { document.getElementById('login-screen').style.display='none'; document.getElementById('dashboard').style.display='block'; loadHost(); } else alert("Access Denied"); }
        function saveHost() { localStorage.setItem('hr_rblx', document.getElementById('h-rblx').value); localStorage.setItem('hr_id', document.getElementById('h-id').value); }
        function loadHost() { document.getElementById('h-rblx').value = localStorage.getItem('hr_rblx')||""; document.getElementById('h-id').value = localStorage.getItem('hr_id')||""; }
        function switchTab(t) { document.querySelectorAll('.content').forEach(c=>c.classList.remove('active')); document.getElementById(t+'-content').classList.add('active'); }
        
        function setTog(k, v, b) { 
            scores[k] = v; 
            b.parentElement.querySelectorAll('.t-btn').forEach(x=>x.className='t-btn');
            b.className = v > 0 ? 't-btn active-green' : 't-btn active-red';
        }

        function addTrainee() {
            const rblx = document.getElementById('t-rblx').value, tid = document.getElementById('t-id').value;
            if(!rblx || !tid) return alert("Fill fields");
            let kS = 0, mS = 0;
            for(let i=1; i<=10; i++) kS += scores['k'+i]||0;
            ['m1','m2','m3','m4'].forEach(k => mS += scores[k]||0);
            const total = kS + mS;
            batch.push({ rblx, id: tid, score: total, status: total >= 30 ? "PASS" : "FAIL", kS, mS, notes: { k: document.getElementById('note-k').value, m: document.getElementById('note-m').value, ov: document.getElementById('note-ov').value } });
            renderBatch(); clearForm();
        }

        async function dqTrainee() {
            const rblx = document.getElementById('t-rblx').value, tid = document.getElementById('t-id').value, hId = document.getElementById('h-id').value;
            const r = prompt("DQ Reason:"); if(!r) return;
            await fetch(CONFIG.WEBHOOK, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ content: `<@${hId}> <@${tid}>`, embeds:[{title:"DISQUALIFIED", color:16711680, thumbnail:{url:CONFIG.THUMBNAIL}, fields:[{name:"User", value:rblx},{name:"Reason", value:r}]}]}) });
            batch.push({ rblx, id: tid, score: 0, status: "DQ", kS:0, mS:0, notes: {ov: "DQ: "+r} });
            renderBatch(); clearForm();
        }

        function renderBatch() {
            const l = document.getElementById('batch-list'); l.innerHTML = batch.length ? "<h3>BATCH</h3>" : "";
            batch.forEach((t, i) => l.innerHTML += `<div class="batch-card">${t.rblx} - ${t.score}/40 (${t.status}) <button class="t-btn active-red" onclick="batch.splice(${i},1);renderBatch()">X</button></div>`);
            document.getElementById('pub-btn').style.display = batch.length ? 'block' : 'none';
        }

        function clearForm() { ['t-rblx','t-id','note-k','note-m','note-ov'].forEach(id=>document.getElementById(id).value=""); scores={}; document.querySelectorAll('.t-btn').forEach(b=>b.className='t-btn'); }

        async function postAnn() {
            const t = document.getElementById('ann-time').value, h = document.getElementById('ann-uid').value;
            if(!t || !h) return alert("Missing Info");
            const ux = Math.floor(new Date(t).getTime()/1000);
            const body = { content: `<@&${CONFIG.ANNOUNCE_ROLE_ID}> <@${h}>`, embeds:[{ title:"NEW TRAINING SESSION", color:16711935, thumbnail:{url:CONFIG.THUMBNAIL}, image:{url:CONFIG.IMG_ANN}, fields:[{name:"Trainer", value:`<@${h}>`, inline:true}, {name:"Type", value:document.getElementById('ann-type').value, inline:true}, {name:"Time", value:`<t:${ux}:F>`}, {name:"Info", value:document.getElementById('ann-desc').value}]}] };
            await fetch(CONFIG.WEBHOOK, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(body)});
            alert("Announced");
        }

        async function postVoiceVerify() {
            const body = { content: `<@${document.getElementById('v-tr-id').value}> <@${document.getElementById('v-tn-id').value}>`, embeds:[{ title:"VOICE VERIFICATION", color:65535, thumbnail:{url:CONFIG.THUMBNAIL}, image:{url:CONFIG.IMG_VV}, fields:[{name:"User", value:document.getElementById('v-name').value, inline:true},{name:"Age", value:document.getElementById('v-age').value, inline:true}]}] };
            await fetch(CONFIG.WEBHOOK, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(body)});
            alert("Verified");
        }

        async function publish() {
            const hId = document.getElementById('h-id').value;
            const pings = `<@${hId}> ` + batch.map(t=>`<@${t.id}>`).join(" ");
            const embeds = batch.map((t, idx) => {
                const f = [{name:"Candidate", value:`${t.rblx} (<@${t.id}>)`, inline:true}, {name:"Score", value:`**${t.score}/40**`, inline:true}, {name:"Breakdown", value:`Knowledge: ${t.kS}/20\nMod/Driving: ${t.mS}/20`}];
                if(t.notes.k) f.push({name:"Knowledge Notes", value:t.notes.k});
                if(t.notes.m) f.push({name:"Mod/Driving Notes", value:t.notes.m});
                if(t.notes.ov) f.push({name:"Final Summary", value:t.notes.ov});
                return { title:`EVALUATION: ${t.status}`, color: t.status==="PASS"?65280:16711680, thumbnail:{url:CONFIG.THUMBNAIL}, image: idx===batch.length-1?{url:CONFIG.IMG_RES}:null, fields: f };
            });
            await fetch(CONFIG.WEBHOOK, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({content:pings, embeds})});
            alert("Published"); batch=[]; renderBatch();
        }
    </script>
</body>
</html>
